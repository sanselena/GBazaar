<!--AŞK buraya öyle bir metod lazım ki hangi ürünün id'si ile bu sayfa açılmışsa o ürünün detayları  gözüksün nasıl olacağına pek kafam basmıyor şu an-->
@model GBazaar.Models.Product

@{
    var usingSampleProduct = ViewBag.UsingSampleProduct is bool sample && sample;
    var priceDisplay = Model.UnitPrice.HasValue
        ? Model.UnitPrice.Value.ToString("C")
        : "Pricing on request";
    var unitSuffix = string.IsNullOrWhiteSpace(Model.UnitOfMeasure)
        ? string.Empty
        : $" / {Model.UnitOfMeasure}";
    var supplierName = Model.Supplier?.SupplierName ?? "Unknown Supplier";
    var supplierInitial = string.IsNullOrWhiteSpace(supplierName)
        ? "?"
        : supplierName.Trim()[0].ToString().ToUpperInvariant();
}

<div class="container mt-5 mb-5">
    <div class="row g-5">
        <div class="col-md-6">
            <div class="main-image-container">
                <div class="arrow arrow-left"><i class="fas fa-chevron-left"></i></div>
                <img src="https://via.placeholder.com/600/C4C1ED/6E6DCC?text=Main+Product+Photo" class="main-img" alt="@Model.ProductName main image">
                <div class="arrow arrow-right"><i class="fas fa-chevron-right"></i></div>
            </div>

            <div class="thumbnail-strip mt-3">
                <img src="https://via.placeholder.com/100/C4C1ED/6E6DCC?text=1" class="thumb active" alt="Product thumbnail 1">
                <img src="https://via.placeholder.com/100/C4C1ED/6E6DCC?text=2" class="thumb" alt="Product thumbnail 2">
                <img src="https://via.placeholder.com/100/C4C1ED/6E6DCC?text=3" class="thumb" alt="Product thumbnail 3">
            </div>
        </div>

        <div class="col-md-6 product-details-col">
            @* === BİLDİRİM ALANI EKLENDİ === *@
            @if (TempData["Success"] != null)
            {
                <div class="alert alert-success">@TempData["Success"]</div>
            }
            @if (TempData["Error"] != null)
            {
                <div class="alert alert-danger">@TempData["Error"]</div>
            }

            @if (usingSampleProduct)
            {
                <div class="alert alert-info mb-3" role="alert">
                    Showing a placeholder listing because the live product catalog is currently unreachable.
                </div>
            }

            <span class="badge bg-secondary mb-2">Wholesale / Bulk</span>
            <h1 class="product-title">@Model.ProductName</h1>

            <div class="supplier-card mb-3 p-2 border rounded d-flex align-items-center gap-3" style="background-color: white;">
                <div class="avatar-circle" style="background-color: var(--primary);">@supplierInitial</div>
                <div>
                    <div style="font-weight: bold; font-size: 0.9rem;">@supplierName</div>
                    <div style="font-size: 0.8rem; color: #666;">Member since 2021 • Success Rate: 94%</div>
                </div>
            </div>

            <div class="rating-section mb-3">
                <span class="stars">
                    <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star-half-alt"></i>
                </span>
                <span class="review-count">(Based on 42 fulfilled orders)</span>
            </div>

            <div class="price-info mb-4">
                <span class="text-muted">Supplier Asking Price:</span>
                <div class="price-tag" style="font-size: 1.5rem;">@priceDisplay<span style="font-size: 1rem; color: #666;">@unitSuffix</span></div>
                <div style="font-size: 0.9rem; color: #28a745;"><i class="fas fa-check-circle"></i> 50,000 kg Available Now</div>
            </div>

            <div class="offer-card p-4" style="background-color: #f8f9fa; border: 2px solid var(--border-pop); border-radius: 15px;">
                <h4 class="mb-3" style="color: var(--text-main); font-weight: 700;">Create Purchase Request</h4>

                <form asp-action="CreatePurchaseRequest" asp-controller="Product" method="post">
                    <!-- Gizli alanlar ile ürün bilgilerini gönder -->
                    <input type="hidden" name="ProductId" value="@Model.ProductID" />
                    <input type="hidden" name="ProductName" value="@Model.ProductName" />
                    <input type="hidden" name="ProductDescription" value="@Model.Description" />
                    <input type="hidden" name="UnitOfMeasure" value="@Model.UnitOfMeasure" />

                    <div class="mb-3">
                        <label class="form-label" style="font-weight: 600;">Quantity Required (@Model.UnitOfMeasure)</label>
                        <input type="number" name="Quantity" class="form-control custom-input" placeholder="e.g. 10000" required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label" style="font-weight: 600;">Your Offer per Unit ($)</label>
                        <div class="input-group">
                            <span class="input-group-text">$</span>
                            <input type="number" name="UnitPrice" class="form-control" placeholder="e.g. @Model.UnitPrice?.ToString("0.00")" step="0.01" required>
                        </div>
                        <small class="text-muted">Supplier is asking for @Model.UnitPrice?.ToString("C").</small>
                    </div>

                    <div class="mb-3">
                        <label class="form-label" style="font-weight: 600;">Note to Supplier</label>
                        <textarea name="Justification" class="form-control" rows="2" style="border-radius: 15px; border: 1px solid #ccc;" placeholder="Need delivery by next Friday..."></textarea>
                    </div>

                    <button type="submit" class="btn w-100" style="background-color: var(--text-main); color: white; border-radius: 50px; padding: 12px; font-weight: bold;">
                        Submit Purchase Request
                    </button>
                </form>
            </div>

